[tox]
env_list =
    py311
minversion = 4.8.0

[testenv]
description = run the tests with pytest
package = wheel
wheel_build_env = .pkg
deps =
    pytest>=6
commands =
    pytest {tty:--color=yes} -s {posargs}

[testenv:mpi]
description = run the tests with pytest with MPI
deps =
    pytest>=6
    pytest-mpi
    mpi4py
setenv =
    MPI_TEST_SIZE = 4
allowlist_externals =
    mpiexec
commands =
    mpiexec -n {env:MPI_TEST_SIZE} pytest {tty:--color=yes} -s -m mpi --only-mpi {posargs}
